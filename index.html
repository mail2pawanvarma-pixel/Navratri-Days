<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Navratri Celebration</title>
<style>
  :root{
    --bg1:#fff0f5; /* pale pink */
    --bg2:#fff4e6; /* cream */
    --accent-magenta:#c71b6b;
    --accent-cyan:#00cfd8;
    --accent-gold:#d4a017;
    --accent-maroon:#7a1226;
    --glass: rgba(255,255,255,0.06);
  }

  html,body{height:100%;margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif; background: linear-gradient(135deg,var(--bg1),var(--bg2)); overflow:hidden; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}

  /* Stage */
  .stage{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;}

/* --------- Landing (first) --------- */
  #landing{
    position:fixed; inset:0; z-index:80;
    display:flex; align-items:center; justify-content:center; flex-direction:column;
    background:
      radial-gradient(circle at 15% 20%, rgba(255,224,230,0.85), transparent 12%),
      radial-gradient(circle at 85% 80%, rgba(255,241,217,0.85), transparent 12%),
      linear-gradient(180deg, rgba(122,18,38,0.06), rgba(255,241,217,0.04));
    padding:28px; box-sizing:border-box;
  }
  .landing-card{
    width:100%; max-width:920px; padding:26px; border-radius:18px;
    display:flex; flex-direction:column; gap:18px; align-items:center;
    backdrop-filter: blur(6px);
    background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.92));
    box-shadow: 0 12px 40px rgba(122,18,38,0.12);
    border:1px solid rgba(122,18,38,0.06);
  }
  .landing-title{
    font-size:clamp(20px,4.8vw,44px); font-weight:800; color:var(--accent-maroon);
    text-align:center;
    background:linear-gradient(90deg,var(--accent-maroon), var(--accent-gold), #ff7aa2);
    -webkit-background-clip:text; background-clip:text; color:transparent;
    text-shadow:0 6px 30px rgba(215,120,140,0.08);
  }
  .landing-sub{ font-size:clamp(14px,3.2vw,18px); color:#6b1020; opacity:0.95; text-align:center; }

  .reveal-btn{
    margin-top:6px;
    background:linear-gradient(90deg,var(--accent-maroon), var(--accent-gold));
    border:none; color:white; padding:14px 28px; border-radius:999px;
    font-weight:800; font-size:16px; cursor:pointer;
    box-shadow: 0 8px 30px rgba(122,18,38,0.18), 0 0 40px rgba(212,160,23,0.12);
    transition:transform .18s ease, box-shadow .18s ease, opacity .18s;
  }
  .reveal-btn:active{transform:translateY(2px)}
  .reveal-desc{ font-size:13px; color:#7a1226; opacity:0.9; }

  /* subtle animated gradient background inside landing card */
  .landing-card::before{
    content:""; position:absolute; inset:0; pointer-events:none; border-radius:18px;
    background:linear-gradient(120deg, rgba(255,200,220,0.06), rgba(255,240,200,0.04));
    mix-blend-mode: overlay;
  }

/* --------- Celebration (hidden until reveal) --------- */
  #celebration{
    position:fixed; inset:0; z-index:10; opacity:0; pointer-events:none;
    display:flex; align-items:center; justify-content:center; padding:20px; box-sizing:border-box;
    transition:opacity .7s ease;
  }
  .card{
    width:100%; max-width:1100px; height:calc(100vh - 40px);
    display:flex; flex-direction:column; align-items:center; gap:14px; padding:22px;
    border-radius:18px; box-sizing:border-box;
    background: linear-gradient(180deg, rgba(255,250,250,0.82), rgba(255,250,245,0.9));
    box-shadow: 0 12px 36px rgba(122,18,38,0.08);
    border:1px solid rgba(122,18,38,0.04);
    overflow:hidden;
  }

  .title{ width:100%; display:flex; flex-direction:column; align-items:center; gap:12px; padding-top:6px; }
  .happy-text{
    font-weight:900; font-size:clamp(28px,5.6vw,72px); line-height:1; text-align:center;
    background: linear-gradient(90deg, var(--accent-maroon), var(--accent-gold), #ff5a84);
    -webkit-background-clip:text; background-clip:text; color:transparent;
    position:relative;
    text-shadow: 0 6px 28px rgba(122,18,38,0.06);
    animation:glowShift 4.6s ease-in-out infinite;
  }
  @keyframes glowShift{0%{filter:drop-shadow(0 0 8px rgba(255,200,120,0.06))}50%{filter:drop-shadow(0 0 16px rgba(255,100,140,0.08))}100%{filter:drop-shadow(0 0 8px rgba(255,200,120,0.06))}}

  .gif-wrap{ width:100%; display:flex; align-items:center; justify-content:center; padding:6px; box-sizing:border-box; }
  img.navratri{ width:clamp(300px,44vw,780px); max-height:60vh; object-fit:cover; border-radius:18px;
    box-shadow: 0 24px 50px rgba(122,18,38,0.12);
    border: 3px solid rgba(212,160,23,0.08);
    animation:gifPulse 6s ease-in-out infinite; z-index:6; }
  @keyframes gifPulse{0%{transform:scale(1)}50%{transform:scale(1.03)}100%{transform:scale(1)}}

  .greeting{
    margin-top:6px; padding:12px 18px; border-radius:12px; display:flex; align-items:center; justify-content:center;
    background: linear-gradient(90deg, rgba(255,240,244,0.8), rgba(255,250,236,0.9)); border:1px solid rgba(122,18,38,0.04);
    box-shadow: 0 8px 26px rgba(122,18,38,0.04);
  }
  .greeting .message{ font-weight:800; font-size:clamp(18px,3.2vw,28px); color:var(--accent-maroon); text-align:center; }
  .greeting .name{
    font-weight:900; padding:2px 8px; margin-right:6px;
    background:linear-gradient(90deg,var(--accent-gold),var(--accent-maroon)); -webkit-background-clip:text; background-clip:text; color:transparent;
    animation:namePulse 3s ease-in-out infinite;
  }
  @keyframes namePulse{0%{transform:scale(1)}50%{transform:scale(1.03)}100%{transform:scale(1)}}

  /* Controls */
  .controls{ display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap; margin-top:12px; z-index:9; width:100%; }
  .input{ min-width:200px; max-width:420px; width:calc(40vw); background:rgba(255,255,255,0.88); border:1px solid rgba(122,18,38,0.06); padding:12px 14px; border-radius:12px; font-size:1.1rem; color:var(--accent-maroon); outline:none; box-shadow:0 8px 20px rgba(0,0,0,0.05); }
  .input::placeholder{ color: #8a2b3b; opacity:0.7; }

  .controls-row{ display:flex; gap:12px; align-items:center; justify-content:center; flex-wrap:wrap; width:100%; margin-top:6px; }

  .gift-button{
    display:inline-flex; align-items:center; gap:10px; padding:12px 18px; border-radius:999px;
    background:linear-gradient(90deg,var(--accent-maroon),var(--accent-gold)); color:white; font-weight:800; text-decoration:none;
    box-shadow: 0 10px 28px rgba(122,18,38,0.14);
    font-size:1.05rem;
  }
  .gift-button.disabled{ opacity:0.56; pointer-events:none; box-shadow:none; }

  .wa-button{
    display:inline-flex; align-items:center; gap:8px; padding:12px 18px; border-radius:999px; background:#075e54; color:#fff; font-weight:800; text-decoration:none;
    box-shadow:0 10px 28px rgba(7,94,84,0.18); font-size:1.05rem;
  }

  /* Floating/layers */
  canvas#fx{ position:absolute; inset:0; width:100%; height:100%; z-index:5; pointer-events:none; }
  .falling-layer, .balloon-layer{ position:absolute; inset:0; pointer-events:none; z-index:7; overflow:hidden; }

  /* Responsive tweaks */
  @media (max-width:640px){
    .input{ width:84%; font-size:1rem; }
    .happy-text{ font-size:clamp(20px,7vw,44px); }
    img.navratri{ width:86%; max-height:46vh; }
    .greeting .message{ font-size:1rem; }
  }
</style>
</head>
<body>
<div class="stage">

  <!-- LANDING SCREEN -->
  <div id="landing" role="dialog" aria-modal="true" aria-label="Landing: reveal celebration">
    <div class="landing-card" role="group" aria-labelledby="landingTitle">
      <div id="landingTitle" class="landing-title">Special Navratri message waiting for you</div>
      <div class="landing-sub">Click the button below to reveal the Navratri celebration.</div>
      <button id="revealBtn" class="reveal-btn" aria-label="Click to reveal celebration">Click to Reveal</button>
      <div class="landing-sub" style="font-size:12px;color:#7a1226;opacity:0.9;">(Music & celebration start after you click)</div>
    </div>
  </div>

  <!-- CELEBRATION SCREEN -->
  <main id="celebration" aria-hidden="true">
    <div class="card" role="main">

      <div class="title">
        <div class="happy-text">Happy Navratri</div>
        <div class="gif-wrap">
          <img id="navGif" class="navratri" src="Navratri.gif" alt="Navratri image (place Navratri.gif in same folder)" />
        </div>

        <div class="greeting" role="status" aria-live="polite">
          <div class="message">
            <span id="nameEl" class="name">Someone</span>
            <span> ki taraf se </span>
            <span id="msgEl">aapko Navratri ki bahut bahut badhai</span>
          </div>
        </div>
      </div>

      <!-- Controls -->
      <div class="controls" aria-label="Inputs and actions">
        <input id="nameInput" class="input" placeholder="Enter your name (optional)" />
        <input id="msgInput" class="input" placeholder="Type your message (optional)" />
      </div>

      <div class="controls-row" style="margin-top:6px;">
        <!-- üî•üî• PASTE YOUR AFFILIATE LINK BELOW üî•üî•
             Replace the value of data-href with your affiliate link (or edit href below).
             If you leave the placeholder, the button will be disabled and won't open anything. -->
        <a id="giftBtn" class="gift-button disabled" href="#" data-href="https://amzn.to/3JXslqk" target="_blank" rel="noopener">üéÅ Special Navratri Gifts üéÅ</a>

        <a id="waShare" class="wa-button" href="#" target="_blank" rel="noopener">Share</a>
      </div>

      <!-- Canvas / layers -->
      <canvas id="fx"></canvas>
      <div id="flowers" class="falling-layer" aria-hidden="true"></div>
      <div id="balloons" class="balloon-layer" aria-hidden="true"></div>
    </div>
  </main>

</div>

<!-- Audio file (local) -->
<audio id="bgAudio" src="Navratri.mp3" preload="auto" loop crossorigin="anonymous"></audio>

<script>
/* Navratri celebration page
   - Landing overlay shows first and is high-contrast
   - On reveal: plays Navratri.mp3, shows celebration, starts effects
   - Gift button opens only when you replace data-href with a real link
   - WhatsApp share builds message with name & msg and opens wa.me
   - Defaults: name = "Someone", msg = "aapko Navratri ki bahut bahut badhai"
*/

/* ----------------- Utilities ----------------- */
const qs = sel => document.querySelector(sel);
const qsa = sel => document.querySelectorAll(sel);
function random(min,max){ return Math.random()*(max-min)+min; }
function safeText(s){ return String(s||'').trim(); }

/* ----------------- Elements ----------------- */
const landing = qs('#landing');
const revealBtn = qs('#revealBtn');
const celebration = qs('#celebration');
const audioEl = qs('#bgAudio');

const navGif = qs('#navGif');
const nameEl = qs('#nameEl');
const msgEl = qs('#msgEl');

const nameInput = qs('#nameInput');
const msgInput = qs('#msgInput');
const giftBtn = qs('#giftBtn');
const waShare = qs('#waShare');

const canvas = qs('#fx');
const ctx = canvas.getContext('2d');
const flowersLayer = qs('#flowers');
const balloonsLayer = qs('#balloons');

let cw, ch;
function resizeCanvas(){ cw = canvas.width = innerWidth; ch = canvas.height = innerHeight; }
resizeCanvas(); window.addEventListener('resize', resizeCanvas);

/* Defaults */
const DEFAULT_NAME = 'Someone';
const DEFAULT_MSG = 'aapko Navratri ki bahut bahut badhai';
let current = { name: DEFAULT_NAME, msg: DEFAULT_MSG };

/* ----------------- URL params -> initial values ----------------- */
(function initFromURL(){
  const p = new URLSearchParams(window.location.search);
  const pName = safeText(p.get('name'));
  const pMsg = safeText(p.get('msg'));
  if(pName) { nameInput.value = pName; current.name = pName; }
  if(pMsg) { msgInput.value = pMsg; current.msg = pMsg; }
  // initial UI greeting
  nameEl.textContent = current.name;
  msgEl.textContent = current.msg;
  updateShareLink();
})();

/* ----------------- Update greeting & share link ----------------- */
function updateGreeting(){
  const n = safeText(nameInput.value) || DEFAULT_NAME;
  const m = safeText(msgInput.value) || DEFAULT_MSG;
  current.name = n; current.msg = m;
  nameEl.textContent = n;
  msgEl.textContent = m;
  updateShareLink();
}
nameInput.addEventListener('input', updateGreeting);
msgInput.addEventListener('input', updateGreeting);

/* Build WhatsApp share link */
function updateShareLink(){
  const n = encodeURIComponent(current.name);
  const m = encodeURIComponent(current.msg);
  const pageUrl = `${location.origin}${location.pathname}?name=${n}&msg=${m}`;
  const text = `${current.name} ki taraf se: ${current.msg} - ${pageUrl}`;
  waShare.href = `https://wa.me/?text=${encodeURIComponent(text)}`;
}

/* ----------------- Gift button behavior ----------------- */
/* If user hasn't replaced the placeholder, disable the button; else enable and open in new tab */
(function initGiftButton(){
  const dataHref = (giftBtn.dataset.href || '').trim();
  if(dataHref && dataHref !== 'YOUR_AFFILIATE_LINK' && !dataHref.startsWith('#') ){
    giftBtn.href = dataHref;
    giftBtn.classList.remove('disabled');
    // ensure opens in new tab (target already set)
    giftBtn.addEventListener('click', (e)=>{
      // default anchor behavior will open in new tab; let it proceed
    });
  } else {
    // disabled: prevent any navigation and keep button visible but muted
    giftBtn.href = 'javascript:void(0)';
    giftBtn.classList.add('disabled');
    giftBtn.addEventListener('click', (e)=>{ e.preventDefault(); /* no-op */ });
  }
})();

/* ----------------- Reveal action ----------------- */
revealBtn.addEventListener('click', async ()=>{
  // Try to play audio (user gesture)
  try { await audioEl.play(); } catch(e){ /* ignore */ }

  // Visual transition: fade out landing and show celebration
  landing.style.transition = 'opacity 700ms ease, transform 700ms ease';
  landing.style.opacity = '0';
  landing.style.transform = 'scale(1.02)';
  // show celebration
  celebration.style.pointerEvents = 'auto';
  celebration.style.opacity = '1';
  celebration.setAttribute('aria-hidden','false');

  // after transition remove landing from DOM (so clicks won't interact)
  setTimeout(()=>{ landing.style.display='none'; landing.setAttribute('aria-hidden','true'); }, 760);

  // start effects
  startAudioEffects(audioEl);
  startFallingFlowers();
  startBalloons();
});

/* Allow keyboard Enter to reveal as accessibility */
document.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter' && landing && landing.style.display !== 'none'){ revealBtn.click(); }
});

/* ----------------- Canvas fireworks/confetti ----------------- */
let particles = [];
class Particle {
  constructor(x,y,vx,vy,size,color,life,shape='circle'){ Object.assign(this,{x,y,vx,vy,size,color,life,age:0,shape}); }
  update(dt){
    this.vy += 0.05 * dt;
    this.x += this.vx * dt;
    this.y += this.vy * dt;
    this.age += dt;
  }
  draw(ctx){
    ctx.save();
    ctx.globalAlpha = Math.max(0,1 - (this.age/this.life));
    if(this.shape==='rect'){
      ctx.fillStyle = this.color;
      ctx.fillRect(this.x - this.size/2, this.y - this.size/2, this.size, this.size);
    } else {
      ctx.fillStyle = this.color;
      ctx.beginPath(); ctx.arc(this.x,this.y,this.size,0,Math.PI*2); ctx.fill();
    }
    ctx.restore();
  }
}

/* spawn burst near gif area */
function spawnBurst(x,y,intensity){
  const colors = [getCSS('--accent-maroon','#7a1226'), getCSS('--accent-gold','#d4a017'), '#ffd6e1', '#fff6d0'];
  const sparks = Math.floor(10 * intensity);
  for(let i=0;i<sparks;i++){
    const angle = random(0,Math.PI*2);
    const speed = random(1,6) * (0.5 + intensity);
    particles.push(new Particle(x,y,Math.cos(angle)*speed,Math.sin(angle)*speed, random(1,3), colors[Math.floor(random(0,colors.length))], random(50,110)));
  }
  const confettiCount = Math.floor(6 * intensity);
  for(let i=0;i<confettiCount;i++){
    particles.push(new Particle(x + random(-20,20), y + random(-10,10), random(-1.5,1.5), random(0.5,2.5), random(4,10), getCSS('--accent-gold','#d4a017'), random(80,140), 'rect'));
  }
}

/* draw loop */
(function renderLoop(){
  ctx.clearRect(0,0,cw,ch);
  for(let i=particles.length-1;i>=0;i--){
    const p = particles[i];
    p.update(1);
    p.draw(ctx);
    if(p.age > p.life || p.x < -50 || p.x > cw+50 || p.y > ch+80) particles.splice(i,1);
  }
  requestAnimationFrame(renderLoop);
})();

/* ----------------- Audio analyser for music-reactive bursts ----------------- */
let audioCtx, analyser, srcNode, dataArray;
function startAudioEffects(audioEl){
  if(window._navAudioStarted) return; window._navAudioStarted = true;
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  analyser = audioCtx.createAnalyser();
  analyser.fftSize = 2048;
  const bufferLength = analyser.frequencyBinCount;
  dataArray = new Uint8Array(bufferLength);
  srcNode = audioCtx.createMediaElementSource(audioEl);
  srcNode.connect(analyser);
  analyser.connect(audioCtx.destination);

  let last = performance.now(), energyAccumulator = 0;
  (function loop(t){
    const dt = Math.min(60, t - last)/16; last = t;
    analyser.getByteFrequencyData(dataArray);
    // compute low-frequency energy
    let lowSum = 0;
    const cutoff = Math.floor(dataArray.length * 0.12);
    for(let i=0;i<cutoff;i++) lowSum += dataArray[i];
    const avg = lowSum / (cutoff||1) / 255;
    energyAccumulator += avg;
    if(energyAccumulator > 1.4){
      const rect = navGif.getBoundingClientRect();
      const x = rect.left + rect.width*0.5 + random(-rect.width*0.25, rect.width*0.25);
      const y = rect.top + random(10, rect.height*0.2);
      spawnBurst(x,y, Math.min(3,1 + avg*6));
      energyAccumulator = 0;
    } else if(avg > 0.09 && Math.random() < 0.03 + avg*0.6){
      const rect = navGif.getBoundingClientRect();
      spawnBurst(rect.left + rect.width*0.5 + random(-rect.width*0.3, rect.width*0.3), rect.top + random(20,rect.height*0.18), Math.max(0.8, avg*2.4));
    }
    requestAnimationFrame(loop);
  })(performance.now());
}

/* helper to read computed CSS variable */
function getCSS(varName, fallback){ try{ const v = getComputedStyle(document.documentElement).getPropertyValue(varName).trim(); return v||fallback; }catch(e){return fallback;} }

/* ----------------- Falling flowers (reduced density) ----------------- */
const FLOWERS = ["üå∫","üå∏","üåº","üåπ","üåª"];
function startFallingFlowers(){
  const base = Math.max(6, Math.floor(innerWidth/140));
  for(let i=0;i<Math.floor(base*0.25);i++) createFlower();
  setInterval(()=>{ if(Math.random()>0.6) createFlower(); }, 950);
}
function createFlower(){
  const el = document.createElement('div');
  el.style.position = 'absolute';
  el.style.zIndex = 12;
  const startX = random(innerWidth*0.12, innerWidth*0.88);
  el.style.left = startX + 'px';
  el.style.top = (-30 + random(-60,0)) + 'px';
  el.style.fontSize = random(16,30) + 'px';
  el.style.willChange = 'transform,opacity';
  el.textContent = FLOWERS[Math.floor(random(0,FLOWERS.length))];
  flowersLayer.appendChild(el);

  const duration = random(4200,9200);
  const endY = innerHeight*0.62 + random(20, innerHeight*0.22);
  const start = performance.now();
  const rot = random(-360,360);
  function frame(t){
    const p = Math.min(1,(t-start)/duration);
    const sway = Math.sin(p*Math.PI*2*random(0.6,1.4))*40;
    const x = startX + sway;
    const y = -40 + p*(endY + random(10,60));
    el.style.transform = `translate(${x - startX}px, ${y}px) rotate(${rot*p}deg)`;
    el.style.opacity = 1 - p*0.95;
    if(p < 1) requestAnimationFrame(frame);
    else el.remove();
  }
  requestAnimationFrame(frame);
}

/* ----------------- Balloons (smaller sizes) ----------------- */
function startBalloons(){
  const bCount = Math.max(5, Math.floor(innerWidth / 200));
  for(let i=0;i<bCount;i++) createBalloon();
  setInterval(()=>{ if(Math.random()>0.5) createBalloon(); }, 2400);
}
function createBalloon(){
  const size = Math.floor(random(20,60)); // smaller now
  const el = document.createElement('div');
  el.style.position='absolute'; el.style.zIndex='11';
  const startX = random(20, innerWidth - 20);
  el.style.left = startX + 'px';
  el.style.top = (-size - 10) + 'px';
  el.style.width = size + 'px';
  el.style.height = Math.round(size*1.18) + 'px';
  el.style.borderRadius = '50%';
  el.style.pointerEvents = 'none';
  el.style.boxShadow = `0 8px 18px rgba(0,0,0,0.18)`;
  el.style.display = 'flex'; el.style.alignItems = 'center'; el.style.justifyContent = 'center';
  el.style.background = `radial-gradient(circle, ${getRandomNeon()}, ${getRandomNeon(0.45)})`;
  balloonsLayer.appendChild(el);

  // simple string
  const stick = document.createElement('div'); stick.style.position='absolute'; stick.style.left=(size/2-1)+'px'; stick.style.top=(Math.round(size*1.18))+'px'; stick.style.width='2px'; stick.style.height=Math.max(18,size*0.6)+'px'; stick.style.background='rgba(0,0,0,0.08)'; el.appendChild(stick);

  const duration = random(7000,15000);
  const driftX = random(-140,140);
  const start = performance.now();
  const flickerSpeed = random(500,1200);
  function frame(t){
    const p = Math.min(1,(t-start)/duration);
    const x = startX + driftX * p + Math.sin(p*Math.PI*3)*10;
    const y = -size - 10 + p*(innerHeight + size + 80);
    el.style.transform = `translate(${x - startX}px, ${y}px) rotate(${Math.sin(p*6)*10}deg)`;
    // flicker
    if(Math.floor(t/flickerSpeed)%2 === 0) el.style.opacity = 0.95;
    else el.style.opacity = 0.6 + Math.random()*0.3;
    if(p < 1) requestAnimationFrame(frame);
    else el.remove();
  }
  requestAnimationFrame(frame);
}
function getRandomNeon(opacity){
  const pool = ['#ff4da6','#ff2d68','#ffd166','#ff9aa2','#b3003b','#ffc857'];
  const c = pool[Math.floor(random(0,pool.length))];
  if(opacity){
    const r = parseInt(c.substr(1,2),16);
    const g = parseInt(c.substr(3,2),16);
    const b = parseInt(c.substr(5,2),16);
    return `rgba(${r},${g},${b},${opacity})`;
  }
  return c;
}

/* ----------------- Share button: already built as waShare href -> open new tab on click if needed */
waShare.addEventListener('click', (e)=>{
  // Using href set earlier (updateShareLink) will open wa.me in new tab; let browser handle it.
  // on desktop, user may see whatsapp web; on mobile, the app opens.
});

/* ----------------- Prevent accidental page jump: remove any href="#" usage (we used javascript:void for disabled gift) */
/* ----------------- All good. ----------------- */

</script>
</body>
</html>